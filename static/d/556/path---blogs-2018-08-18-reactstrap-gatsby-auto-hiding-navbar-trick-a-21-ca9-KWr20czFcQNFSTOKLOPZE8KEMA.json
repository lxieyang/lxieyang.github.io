{"data":{"markdownRemark":{"html":"<h3>Disclaimer</h3>\n<p>First things first, I do not claim to be an <a href=\"https://reactjs.org\">React</a>/<a href=\"https://www.gatsbyjs.org\">Gatsby</a> expert. The following content is just something I figured out by trial-and-error and would like to document / share with other <a href=\"https://reactjs.org\">React</a>/<a href=\"https://www.gatsbyjs.org\">Gatsby</a> hackers.</p>\n<h3>Problem Description</h3>\n<p>See the nice auto-hiding Navbar on this site? That took me a while to implement. Not that it's a difficult task, but it's was rediculously hard to make it perform correctly (or shall I say, elegantly) across browsers/platforms. Basically, I want it to <strong>auto-hide when you are scrolling down, and auto-reveal when you are scrolling up</strong>. Every bit of srenn real estate matters, especially in a mobile-first world.</p>\n<p>First let's get some context out of the way: I'm using bootstrap with React, so Reactstrap is the default way to go. You could either have a <em>fixed</em> navbar or a <em>non-fixed</em> one, but not an <em>auto-hiding/auto-revealing</em> one. If you ever have found yourself typing something like \"reactstrap auto hiding navbar\" into Google, you're probably in a similar situation. Fortunately, there are many hacks that sort of works available as open-source. However, since you are using React, you probably don't want to mix any jQuery stuff into your code (my take is you really shouldn't), so packages written with jQuery like <a href=\"https://www.virtuosoft.eu/code/bootstrap-autohidingnavbar/\">Bootstrap Auto-Hiding Navbar</a> are out of consideration. And unfortunately, that rules out almost all of them. </p>\n<h3>The Solution</h3>\n<p>I tested out a couple of solutions. One of them works <em>almost</em> perfectly for me, which is available at <a href=\"https://www.w3schools.com/howto/howto_js_navbar_hide_scroll.asp\">How TO - Hide Menu on Scroll - W3Schools.com</a>. If you try it out in Chrome or Firefox, it works like a charm, which concluded my first attempt to build this fancy navbar. </p>\n<p>However, if you happen to be using Safari on a Mac, problems starts to reveal. And it sucks a lot: when you scroll to the very bottom, the navbar will \"magically\" reveal itself; when you scroll back to the very top, the navbar will \"magically\" disappear. Something like the following:</p>\n<p><img alt=\"scroll-down\" style=\"max-width: 400px\" src=\"/scrolling-down-hit-bottom-safari-d5de5310e1576412083de40ac0658ccb.gif\"> <img alt=\"scroll-down\" style=\"max-width: 400px\" src=\"/scrolling-up-hit-top-safari-60742fb022e99a5f72b023b7e3b3b238.gif\"></p>\n<p>And this undersirable effect also applys to mobile browsing using Safari.</p>\n<h3>The Ultimate Solution</h3>\n<p>The cause of this effect is that Safari allows \"over-scroll\" and will display a bouncy effect once you do so. I'm guessing it's a UX sugar? Anyway, in this case, it's super annoying.</p>\n<p>To resolve this, you have to carefully come up with edge fixes for Safari. Here's what I end up putting in my <code class=\"language-text\">./src/components/header/header.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./header.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  Container<span class=\"token punctuation\">,</span>\n  Collapse<span class=\"token punctuation\">,</span>\n  Navbar<span class=\"token punctuation\">,</span>\n  NavbarToggler<span class=\"token punctuation\">,</span>\n  Nav<span class=\"token punctuation\">,</span>\n  NavItem<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'reactstrap'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">...</span> <span class=\"token operator\">...</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ListLink</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>NavItem style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>marginBottom<span class=\"token punctuation\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"navlink\"</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>route<span class=\"token punctuation\">}</span> activeClassName<span class=\"token operator\">=</span><span class=\"token string\">\"active\"</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>routeName<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>NavItem<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Header</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    isOpen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleNavbar<span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// https://www.w3schools.com/howto/howto_js_navbar_hide_scroll.asp</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> prevScrollpos <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>pageYOffset<span class=\"token punctuation\">;</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onscroll</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> maxScroll <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>clientHeight <span class=\"token operator\">-</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> currentScrollPos <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>pageYOffset<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">(</span>maxScroll <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> prevScrollpos <span class=\"token operator\">></span> currentScrollPos <span class=\"token operator\">&amp;&amp;</span> prevScrollpos <span class=\"token operator\">&lt;=</span> maxScroll<span class=\"token punctuation\">)</span> \n          <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>maxScroll <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> prevScrollpos <span class=\"token operator\">></span> currentScrollPos<span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>prevScrollpos <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> currentScrollPos <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"navbar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"navbar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token string\">\"-5.0rem\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        prevScrollpos <span class=\"token operator\">=</span> currentScrollPos<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">toggleNavbar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>isOpen<span class=\"token punctuation\">:</span> <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOpen<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>fontSize<span class=\"token punctuation\">:</span> <span class=\"token string\">'1.2rem'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Navbar id<span class=\"token operator\">=</span><span class=\"token string\">\"navbar\"</span> color<span class=\"token operator\">=</span><span class=\"token string\">\"light\"</span> light expand<span class=\"token operator\">=</span><span class=\"token string\">\"md\"</span> fixed<span class=\"token operator\">=</span><span class=\"token string\">\"top\"</span><span class=\"token operator\">></span> \n          <span class=\"token operator\">&lt;</span>Container<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>NavbarToggler className<span class=\"token operator\">=</span><span class=\"token string\">\"mr-2\"</span> onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggle<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span>Collapse isOpen<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>isOpen<span class=\"token punctuation\">}</span> navbar<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>Nav className<span class=\"token operator\">=</span><span class=\"token string\">\"ml-auto\"</span> navbar<span class=\"token operator\">></span>\n                <span class=\"token operator\">&lt;</span>ListLink route<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span> routeName<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'Home'</span><span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                <span class=\"token operator\">...</span> <span class=\"token operator\">...</span> <span class=\"token comment\">// More links</span>\n              <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Nav<span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Collapse<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Container<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Navbar<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Header<span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"title":"Reactstrap/Gatsby Auto-hiding Navbar Trick","date":"2018-08-18"}}},"pageContext":{"slug":"/blogs/2018-08-18-reactstrap-gatsby-auto-hiding-navbar-trick/"}}
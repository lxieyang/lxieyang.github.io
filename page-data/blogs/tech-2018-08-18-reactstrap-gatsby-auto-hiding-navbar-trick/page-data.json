{"componentChunkName":"component---src-templates-blog-post-blog-post-js","path":"/blogs/tech-2018-08-18-reactstrap-gatsby-auto-hiding-navbar-trick/","webpackCompilationHash":"33933b5c6118802f69ca","result":{"data":{"site":{"siteMetadata":{"title":"Michael Xieyang Liu"}},"markdownRemark":{"html":"<h3>Disclaimer</h3>\n<p>First things first, I do not claim to be an <a href=\"https://reactjs.org\">React</a>/<a href=\"https://www.gatsbyjs.org\">Gatsby</a> expert. The following content is just something I figured out by trial-and-error and would like to document / share with other <a href=\"https://reactjs.org\">React</a>/<a href=\"https://www.gatsbyjs.org\">Gatsby</a> hackers.</p>\n<h3>Problem Description</h3>\n<p>See the nice auto-hiding Navbar on this site? That took me a while to implement. Not that it's a difficult task, but it's was rediculously hard to make it perform correctly (or shall I say, elegantly) across browsers/platforms. Basically, I want it to <strong>auto-hide when you are scrolling down, and auto-reveal when you are scrolling up</strong>. Every bit of srenn real estate matters, especially in a mobile-first world.</p>\n<p>First let's get some context out of the way: I'm using <a href=\"https://getbootstrap.com/\">Bootstrap</a> with <a href=\"https://reactjs.org\">React</a>, so <a href=\"https://reactstrap.github.io/\">Reactstrap</a> is the default way to go. You could either have a <em>fixed</em> navbar or a <em>non-fixed</em> one, but not an <em>auto-hiding/auto-revealing</em> one. If you ever have found yourself typing something like \"reactstrap auto hiding navbar\" into <a href=\"https://www.google.com/search?q=reactstrap+auto+hiding+navbar\">Google</a>, you're probably in a similar situation. Fortunately, there are many hacks that sort of works available as open-source. However, since you are using <a href=\"https://reactjs.org\">React</a>, you probably don't want to mix any <a href=\"https://jquery.com/\">jQuery</a> stuff into your code (my take is you really shouldn't), so packages written with <a href=\"https://jquery.com/\">jQuery</a> like <a href=\"https://www.virtuosoft.eu/code/bootstrap-autohidingnavbar/\">Bootstrap Auto-Hiding Navbar</a> are out of consideration. And unfortunately, that rules out almost all of them. </p>\n<h3>The Solution</h3>\n<p>I tested out a couple of solutions. One of them works <em>almost</em> perfectly for me, which is available at <a href=\"https://www.w3schools.com/howto/howto_js_navbar_hide_scroll.asp\">How TO - Hide Menu on Scroll - W3Schools.com</a>. If you try it out in Chrome or Firefox, it works like a charm, which concluded my first attempt to build this fancy navbar. </p>\n<p>However, if you happen to be using Safari on a Mac, problems starts to reveal. And it sucks a lot: when you scroll to the very bottom, the navbar will \"magically\" reveal itself; when you scroll back to the very top, the navbar will \"magically\" disappear. Something like the following:</p>\n<p><img alt=\"scroll-down\" style=\"max-width: 400px\" src=\"/scrolling-down-hit-bottom-safari-d5de5310e1576412083de40ac0658ccb.gif\"> <img alt=\"scroll-down\" style=\"max-width: 400px\" src=\"/scrolling-up-hit-top-safari-60742fb022e99a5f72b023b7e3b3b238.gif\"></p>\n<p>And this undersirable effect also applys to mobile browsing using Safari.</p>\n<h3>The Ultimate Solution</h3>\n<p>The cause of this effect is that Safari allows \"over-scroll\" and will display a bouncy effect once you do so. I'm guessing it's a UX sugar? Anyway, in this case, it's super annoying.</p>\n<p>To resolve this, you have to carefully come up with edge fixes for Safari. Here's what I end up putting in my <code class=\"language-text\">./header.js</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./header.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Container<span class=\"token punctuation\">,</span> Collapse<span class=\"token punctuation\">,</span> Navbar<span class=\"token punctuation\">,</span> NavbarToggler<span class=\"token punctuation\">,</span> Nav<span class=\"token punctuation\">,</span> NavItem <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'reactstrap'</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span> <span class=\"token operator\">...</span> <span class=\"token comment\">// Other imports</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">ListLink</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token comment\">// ListLink implementation omitted</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Header</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggle <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">toggleNavbar</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// https://www.w3schools.com/howto/howto_js_navbar_hide_scroll.asp</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> window <span class=\"token operator\">!==</span> <span class=\"token string\">'undefined'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> prevScrollpos <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>pageYOffset<span class=\"token punctuation\">;</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onscroll</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> maxScroll <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>clientHeight <span class=\"token operator\">-</span> window<span class=\"token punctuation\">.</span>innerHeight<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> currentScrollPos <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>pageYOffset<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token punctuation\">(</span>maxScroll <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> prevScrollpos <span class=\"token operator\">></span> currentScrollPos <span class=\"token operator\">&amp;&amp;</span> prevScrollpos <span class=\"token operator\">&lt;=</span> maxScroll<span class=\"token punctuation\">)</span> \n          <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>maxScroll <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> prevScrollpos <span class=\"token operator\">></span> currentScrollPos<span class=\"token punctuation\">)</span>\n          <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>prevScrollpos <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> currentScrollPos <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"navbar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"navbar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>top <span class=\"token operator\">=</span> <span class=\"token string\">\"-5.0rem\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// adjustable based your need</span>\n        <span class=\"token punctuation\">}</span>\n        prevScrollpos <span class=\"token operator\">=</span> currentScrollPos<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Navbar id<span class=\"token operator\">=</span><span class=\"token string\">\"navbar\"</span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* other attributes omitted*/</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> \n          <span class=\"token operator\">...</span> <span class=\"token operator\">...</span> <span class=\"token comment\">// Navbar implemetation omitted</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Navbar<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Header<span class=\"token punctuation\">;</span></code></pre></div>\n<p>and <code class=\"language-text\">./header.css</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\"># navbar</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> top 0.5s\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>which is based on the W3Schools.com solution mentioned above.</p>\n<p>To check the source code in full context: <a href=\"https://github.com/lxieyang/lxieyang.github.io/tree/gatsby-dev/src/components/header\">header.js and header.css</a>.</p>\n<p>Now, everything looks perfect, everywhere. I'm not going to put a gif here when you can simply scroll the page yourself to test it out.</p>\n<p>🤪 </p>\n<p>Happy hacking. Michael out.</p>","id":"c8035447-c7b6-5ab9-a44e-b42ff4174170","excerpt":"Disclaimer First things first, I do not claim to be an React/Gatsby expert. The following content is just something I figured out by trial…","frontmatter":{"title":"Reactstrap/Gatsby Auto-hiding Navbar Trick","date":"August 18, 2018"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blogs/tech-2018-08-18-reactstrap-gatsby-auto-hiding-navbar-trick/","previous":{"fields":{"slug":"/blogs/tech-2018-08-02-rewrite-with-gatsby-js/"},"frontmatter":{"title":"Hello World! I rebuilt this site with Gatsby.js!"}},"next":null}}}